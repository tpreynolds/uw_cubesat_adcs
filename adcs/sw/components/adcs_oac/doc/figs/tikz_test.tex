\documentclass{standalone}
\input{../preamble.tex}
\input{../my_tikz.tex}

\begin{document}

\begin{tikzpicture}
\tikzmath{
	\x1=-5; \y1=4; \stp=1;
	\y2=\y1-\stp;
	\y3=\y2-\stp;
	\y4=\y3-\stp;
	\y5=\y4-\stp;
	\y6=\y5-\stp;
	\y7=\y6-\stp;
	\y8=\y7-\stp;
	\y9=\y8-\stp;
	\xo1=3.75; \yo1=3; \stpo=3;
	\yo2=\yo1-\stpo;
	\yo3=\yo2-\stpo;
}

% draw main blocks
\node[draw, thick, rectangle, minimum height=10cm, minimum width=8cm] at (0,0) {};
\node[draw, thick, rectangle, minimum height=4cm, minimum width=2.25cm,name=soac] at (-1.5,1) {SOAC};
\node[draw, thick, rectangle, minimum height=4cm, minimum width=2.25cm,name=interp] at (1.5,-1.5) {INTERP};
% draw inputs
\node[input,name=sc_mode] at (\x1,\y1) {};
\node[input,name=quat_in] at (\x1,\y2) {};
\node[input,name=w_in] at (\x1,\y3) {};
\node[input,name=hw_in] at (\x1,\y4) {};
\node[input,name=quat_cmd] at (\x1,\y5) {};
\node[input,name=w_cmd] at (\x1,\y6) {};
\node[input,name=sI] at (\x1,\y7) {};
\node[input,name=time_epoch] at (\x1,\y8) {};
\node[input,name=time_cur] at (\x1,\y9) {};
% draw outputs
\node[output,name=cmd_torque] at (\xo1,\yo2) {};
\node[output,name=cmd_state] at (\xo1,\yo3) {};
\node[output,name=soln] at (\xo1,\yo1) {};

% draw input/outout arrows
\draw[thick,->] (sc_mode) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{sc\_mode}};
\draw[thick,->] (quat_in) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{quat\_in}};
\draw[thick,->] (w_in) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{w\_in\_radps}};
\draw[thick,->] (hw_in) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{hw\_in\_Nms}};
\draw[thick,->] (quat_cmd) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{quat\_cmd}};
\draw[thick,->] (w_cmd) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{w\_cmd\_radps}};
\draw[thick,->] (sI) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{sun\_inertial\_unit}};
\draw[thick,->] (time_epoch) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{MET\_epoch}};
\draw[thick,->] (time_cur) -- ++(1.25,0) node[pos=0.5,anchor=south east] {\ttt{MET\_current}};
\draw[thick,->] (cmd_torque) -- ++(1.25,0) node[pos=0.5,anchor=south west] {\ttt{command\_torque}};
\draw[thick,->] (cmd_state) -- ++(1.25,0) node[pos=0.5,anchor=south west] {\ttt{command\_state}};
\draw[thick,->] (soln) -- ++(1.25,0) node[pos=0.5,anchor=south west] {\ttt{soac\_solution}};

% draw internal guts
\node[sum_blank,name=tsum] at (\x1+1.75,0.5*\y8+0.5*\y9) {};
\draw[color=gray,->,thick] ($(time_epoch)+(1.25,0)$) -| (tsum.north) node[pos=0.8,anchor=west] {$-$};
\draw[color=gray,->,thick] ($(time_cur)+(1.25,0)$) -| (tsum.south);
\draw[color=gray,->,thick,densely dotted] (tsum.east) -- ($(tsum.east)+(2.5,0)$) |- (interp.south west);

\draw[color=gray,thick,->] (interp.east) -- ($(interp.east)+(0.5,0)$) |- (cmd_state);
\draw[color=gray,thick,->] (interp.east) -- ($(interp.east)+(0.5,0)$) |- (cmd_torque);
\draw[color=gray,thick,->] (soac.east) -- ($(soac.east)+(1.86,0)$) |- (soln);
\draw[color=gray,thick,->] (soac.east) -| (interp.north);

% \draw[help lines] (-5,-5) grid (5,5);
% \filldraw[red!100] (0,0) circle (2pt);

\end{tikzpicture}

\end{document}